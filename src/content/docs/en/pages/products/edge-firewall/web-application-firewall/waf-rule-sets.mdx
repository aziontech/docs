---
title: WAF Rule Sets
description: The WAF Rule Set protects your applications against threats such as SQL Injections, Remote File Inclusion (RFI), Cross-Site Scripting (XSS) and more.
meta_tags: waf, rule set, edge computing
namespace: documentation_products_web_application_firewall_waf_rule_sets
permalink: /documentation/products/edge-firewall/waf-rule-sets/
---

The **WAF Rule Set** protects your applications against threats such as SQL Injections, Remote File Inclusion (RFI), Cross-Site Scripting (XSS) and more. WAF analyzes HTTP and HTTPS requests, detects and blocks malicious acts before they reach your infrastructure, without impacting the performance of your applications.

---

## Monitoring threat detection

Leave the **WAF Rule Set** in **Counting Mode** for as long as you deem necessary so that most of your application's functionality is covered. 

> You should follow the graphics on the **WAF** tab through **Real-Time Metrics** > **Edge Applications** or the **WAF logs** through **Real-Time Events** and **Data Streaming** products. 

In **Real-Time Metrics**, the first graph on the *WAF* tab *(Threats vs Requests)* shows three time series:

*   **Regular Requests:** all HTTP and HTTPS requests are analyzed by WAF and are considered secure.
*   **Threats:** the volume of threats detected by WAF and accounted for, when in **Counting** mode. These threats are not being blocked at the moment.
*   **Threats Blocked:** threats effectively blocked by WAF. To start blocking the threats found, the rule set must be in **Blocking Mode**.

If you also have the **Data Streaming** service, you can track more detailed information about IP, date and time of access, status code, detected attack family and the configured mode of action.

~~~
$time-iso8601 $azion-client-id $azion-virtualhost-id $azion-configuration-id $azion-solution $azion-solution-id $host $conn-request-time $req-method $resp-status $req-uri $waf-threat-family $waf-threat-action $client-geoip-country-name $client-geoip-region-name $client-addr $client-port $req-header(User-Agent) $req-header(Referer) 2017-01-04T17:00:19+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.129 GET 200 /request-uri?key=value $XSS $LEARNING-BLOCK Brazil Sao Paulo 1.2.3.4 61511 Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:19+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.025 POST 200 /request-uri $SQL $LEARNING-BLOCK Brazil Santa Catarina 2.3.4.5 61513 Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:40+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.026 GET 301 /request-uri?key=value $RFI $LEARNING-BLOCK Brazil Rio de Janeiro 5.6.7.8 26102 Mozilla/5.0 (Linux; Android 5.1.1; SM-G800H Build/LMY47X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.91 Mobile Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:41+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.391 POST 200 /request-uri $UWA $LEARNING-BLOCK Brazil Rio Grande do Sul 9.10.11.12 26102 Mozilla/5.0 (Linux; Android 5.1.1; SM-G800H Build/LMY47X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.91 Mobile Safari/537.36 https://www.yoursite.com/referrer
~~~

Based on this information, you can adjust the sensitivity of the *WAF Rule Set*, until no more false positives occur. You can also ask Azion to generate a *whitelist* for your application.
