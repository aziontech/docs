---
title: How to manage KV Store with Edge Functions
description: >-
  
meta_tags: 'edge sql, storage, cloud, SQL, sqlite, data'
namespace: documentation_products_kv_store_manage_edge_functions
permalink: /documentation/products/guides/kv-store/manage-with-functions/
---

import LinkButton from 'azion-webkit/linkbutton'

See how to retrieve data from a with KV Store and Edge Functions.

<LinkButton link="/en/documentation/products/store/kv-store/" label="Go to KV Store reference" severity="secondary" />

---

## Requirements 

- [Azion Edge Functions enabled](/en/documentation/products/build/edge-application/edge-functions/).
---

## Creating a kv
:
---

## Creating an edge function to communicate with KV Store

1. Access [Azion Console](https://console.azion.com).
2. On the upper-left corner, select **Edge Functions** in the **Edge Libraries** section.
3. Click the **+ Edge Function** button.
4. Choose a name for your function.
5. Delete the placeholder function that is inside the code editor. 
6. Paste the following code: 

```js
import { Database } from "azion:sql";

async function db_query() {
  let connection = await Database.open("mydatabase");
  let rows = await connection.query("select * from users");
  let column_count = rows.columnCount();
  let column_names = [];
  for (let i = 0; i < column_count; i++) {
    column_names.push(rows.columnName(i));
  }
  let response_lines = [];
  response_lines.push(column_names.join("|"));
  let row = await rows.next();
  while (row) {
    let row_items = [];
    for (let i = 0; i < column_count; i++) {
      row_items.push(row.getString(i));
    }
    response_lines.push(row_items.join("|"));
    row = await rows.next();
  }
  const response_text = response_lines.join("\n");
  return response_text;
}

async function handle_request(request) {
  if (request.method != "GET") {
    return new Response("Method not allowed", { status: 405 });
  }
  try {
    return new Response(await db_query());
  } catch (e) {
    console.log(e.message, e.stack);
    return new Response(e.message, { status: 500 });
  }
}

addEventListener("fetch", (event) =>
  event.respondWith(handle_request(event.request))
);
``` 




<LinkButton link="/en/documentation/products/guides/build/instantiate-edge-functions/" label="go to How to instantiate edge functions in your application" severity="secondary" />


