---
title: How to find the score of WAF blocked requests
description: Learn how to find more information on WAF blocked requests with Azion.
meta_tags: web application firewall, waf, azion, waf score, real-time events, edge firewall
namespace: documentation_products_guides_how_to_find_waf_score
permalink: /documentation/products/guides/how-to-find-waf-score
---

Azion **Web Application Firewall (WAF)** generates relevant results to maintain the security of your edge applications. This information can be accessed through **Real-Time Events**, using specific *queries*.

> Visit the [Real-Time Events](en/documentation/products/real-time-events/) documentation for more information about this product.

This guide includes some WAF queries available in Real-Time Events to access the data of requests blocked by WAF, to understand the reason why they were blocked, and troubleshoot false positives.

## WAF queries in Real-Time Events

To find information on requests blocked by WAF in Real-Time Events, follow the steps:

1. Access [Real-Time Manager (RTM)](https://manager.azion.com).
2. Open the **Products Menu**, indicated by the three horizontal lines, and click **Real-Time Events**.
3. In the **Data Source** field, select **Edge Applications**.
4. In the dropdown menu, next to **Data Source**, set the desired time interval.
	- For example: requests made in the `Last 15 minutes`, or choose a time range.
5. In the **Filter by** field, type the search queries.

Here are two queries that can be used to find WAF blocked requests:

`host = 'domain.com' AND waf_attack_action = '$BLOCK'`

`host = 'domain.com' AND status = '400' AND upstream_status = '0'`

In both examples, swap `domain.com` with the domain of your edge application.

6. Click the **Search** button.
   > The results of these two queries should be similar, but it is possible to find small variations between the answers.

7. Select and click on one of the results in the list to access all the data regarding this request.

After running these queries and selecting a request, numerous data will be shown. However, in the context of WAF, we will analyze `status`, `upstream_status`, `waf_attack_action`, `waf _block`, `waf_headers`, `waf_learning`, `waf_match`, and `waf_score`. See the table below for the definition of each of these fields.

| Field | Description |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------|
| `status` | Status code returned to the requesting user. Typically, requests blocked by WAF return status 400 (Bad Request). |
| `upstream_status` | This is the response from the origin server of the application. It can be 0 or the same status response (field above). If it is 0, it means that the request did not even reach the origin server (because it does not need to, in cases where the application is already cached on Azion's Edge Nodes, or when it is blocked by WAF). |
| `waf_attack_action` | Action taken by WAF. |
| `waf_attack_family` | Which threat family this request was framed. |
| `waf_block` | Boolean (1 or 0). Value `1` indicates that the request should be blocked by WAF, but only if it is configured in `blocking` mode. `0` indicates that it was not blocked by WAF. |
| `waf_headers` | Request headers, encoded in Base64. |
| `waf_learning` | Boolean (1 or 0). The value `1` indicates that the WAF is operating in learning mode and the value `0`, indicates operation in blocking mode. |
| `waf_match` | Show where the threat indicatives were found. The value of this field contains the ID of the possible threat family and the location of where the possible attack was found. Example: `0:10:ARGS:state`. In this case, the ID of the threat family (10), the location of the suspicious code, in the arguments (ARGS), specifically in the `state` argument (state). |
| `waf_score` | Final value after the sum of all threat indicatives. |

The higher the value of the `waf_score` field, the more indicative of threats were found in this request. If the result is `-` it means that no indication of threat has been found. This means, the stricter the sensitivity level defined in your WAF, the greater the number of low `waf_score` blocked requests.

See the scores for each sensitivity level available in the [Web Application Firewall](en/documentation/products/edge-firewall/web-application-firewall/) documentation. To find out if your WAF is operating in learning or blocking mode, you can use this same method, and check the `waf_learning` field, or see [How to check your WAF mode](en/documentation/products/guides/how-to-check-your-waf-mode/) guide.