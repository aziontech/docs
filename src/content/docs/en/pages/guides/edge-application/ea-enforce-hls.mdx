---
title: How to enforce HLS cache for live streaming delivery
description: This guide covers the step-by-step to enforce HLS cache, managing chunks and playlists caching and setting up rules engines rules.
meta_tags: architecture, content delivery, hls, edge computing
namespace: docs_guides_enforce_hls_cache
permalink: /documentation/products/guides/enforce-hls-cache/
---

import Button from '~/components/Button.astro';
import Tabs from '~/components/tabs/Tabs'

:::caution[important]
Azion has two user interfaces: Real-Time Manager and Console, which is in Preview stage. Currently, Console is only available for Developer plans and new accounts. Follow the steps according to the user interface you're using.
:::

Azion Edge Platform allows you to deliver live streaming content in **HLS format**, being able to easily self-provision and configure your cache policies. This guide covers the step-by-step to enforce HLS cache, managing chunks and playlists caching and setting up rules engines rules.

<Button href="/en/documentation/architecture/live-streaming-delivery/live-streaming-delivery-with-hls/" text="go to live streaming delivery architecture" variant="secondary"></Button>

---

## Requirements

- An Azion edge application, or [creating a new one](/en/documentation/products/guides/build/build-an-application/).
- [A domain associated with the edge application](/en/documentation/products/guides/configure-a-domain/).
- [Tiered Cache enabled](/en/documentation/products/guides/billing-and-subscriptions/) in your account.

---

## Enforcing cache policies for HLS

To enforce cache policies for HLS in the edge application, follow the steps as explained next.

### Creating a cache policy for the chunks

First, you must to create a cache policy for the chunks:


<Tabs client:visible>
    <Fragment slot="tab.console">Console </Fragment>
    <Fragment slot="tab.rtm">Real-Time Manager </Fragment>

<Fragment slot="panel.console">
1. Access [Azion Console](https://console.azion.com/).
2. Go to **Products menu** > **Edge Application**.
3. Select your application.
4. Open the **Cache Settings** tab and click the **+ Cache Setting** button to create the new cache policy:
- Give it a unique name.
- In **Cache Expiration Policies**:
    - For **Browser Cache Settings**, select **Override Cache Setting** and define a **Maximum TTL** of `0`.
    - For **Edge Cache Settings**, select **Override Cache Setting** and define a **Maximum TTL** of `60`.
- Enable the **Tiered Cache** switch.
- In the **Advanced Cache Key** section, define the behavior of your application toward cache segmentation of objects.
    - The recommendation is selecting **Content does not vary**, for **Query String** and/or **Cookies**, according to your needs.
5. Click the **Save** button.
</Fragment>

<Fragment slot="panel.rtm">
1. Access [Real-Time Manager](https://manager.azion.com/).
2. Go to **Products menu** > **Edge Application**.
3. Select your application.
4. Open the **Cache Settings** tab and click the **Add Cache Settings** button to create the new cache policy:
- Give it a unique name.
- In **Expiration Settings**:
    - For **Browser Cache Settings**, select **Override Cache Setting** and define a **Maximum TTL** of `0`.
    - For **CDN Cache Settings**, select **Override Cache Setting** and define a **Maximum TTL** of `60`.
- Enable the **Tiered Cache** switch.
- In the **Advanced Cache Key** section, define the behavior of your application toward cache segmentation of objects.
    - The recommendation is selecting **Content does not vary**, for **Query String** and/or **Cookies**, according to your needs.
5. Click the **Save** button.
</Fragment>

</Tabs>
    
### Creating cache policies for the playlist

<Tabs client:visible>
    <Fragment slot="tab.console">Console </Fragment>
    <Fragment slot="tab.rtm">Real-Time Manager </Fragment>

<Fragment slot="panel.console">
Still on the **Cache Settings** tab, click the **+ Cache Setting** button again to create a new cache policy for the playlist:

- For **Browser Cache Settings**, select **Override Cache Setting** and define a **Maximum TTL** of `0`.
- For **Edge Cache Settings**, select **Override Cache Setting** and define a **Maximum TTL** of `5`.
- Enable the **Tiered Cache** switch.
- In the **Advanced Cache Key** section, define the behavior of your application toward cache segmentation of objects.
    - The recommendation is selecting **Content does not vary**, for **Query String** and/or **Cookies**, according to your needs.

Then, click the **Save** button.
</Fragment>

<Fragment slot="panel.rtm">
Still on the **Cache Settings** tab, click the **Add Cache Settings** button again to create a new cache policy for the playlist:

- For **Browser Cache Settings**, select **Override Cache Setting** and define a **Maximum TTL** of `0`.
- For **CDN Cache Settings**, select **Override Cache Setting** and define a **Maximum TTL** of `5`.
- Enable the **Tiered Cache** switch.
- In the **Advanced Cache Key** section, define the behavior of your application toward cache segmentation of objects.
    - The recommendation is selecting **Content does not vary**, for **Query String** and/or **Cookies**, according to your needs.

Then, click the **Save** button.
</Fragment>

</Tabs>

:::tip
Read more about setting up [cache settings](/en/documentation/products/build/edge-application/cache-settings/) for your edge applications.
:::

### Creating Rules Engine rules

<Tabs client:visible>
    <Fragment slot="tab.console">Console </Fragment>
    <Fragment slot="tab.rtm">Real-Time Manager </Fragment>

<Fragment slot="panel.console">
Still on the application page, open the **Rules Engine** tab:

First, create a rule for the chunks: 
1. Click the **+ Rule** button.
2. Give a name and a description (optional) to your rule.
3. Select the **Request Phase** option.
4. In **Criteria**, define `if ${uri}` *matches* `.\*.ts`.
5. In **Behaviors**, select **Set Cache Policy** and add the policy for the chunks you created in the previous step.
6. Click the **Save** button.

Now, create a rule for the playlist: 
1. Click the **+ Rule** button.
2. Give a name and a description (optional) to your rule.
3. Select the **Request Phase** option.
4. In **Criteria**, define `if ${uri}` *matches* `\*.m3u8`.
5. In **Behaviors**, select **Set Cache Policy** and add the policy for the playlist you created in the previous step.
6. Click the **Save** button.
</Fragment>

<Fragment slot="panel.rtm">
Still on the application page, open the **Rules Engine** tab:

First, create a rule for the chunks: 
1. Click the **New Rule** button and select the **Request Phase** option.
2. Give a name and a description (optional) to your rule.
3. In **Criteria**, define `if ${uri}` *matches* `.\*.ts`.
4. In **Behaviors**, select **Set Cache Policy** and add the policy for the chunks you created in the previous step.
5. Click the **Save** button.

Now, create a rule for the playlist: 
1. Click the **New Rule** button and select the **Request Phase** option.
2. Give a name and a description (optional) to your rule.
3. In **Criteria**, define `if ${uri}` *matches* `\*.m3u8`.
4. In **Behaviors**, select **Set Cache Policy** and add the policy for the playlist you created in the previous step.
5. Click the **Save** button.
</Fragment>

</Tabs>

Done! Now you can configure your source and encoder pointing to Azion and stream your content, enforcing HLS cache.

:::tip
Go to the [Rules Engine for Edge Application](/en/documentation/products/build/edge-application/rules-engine/) documentation for more details.
:::

---

import ContributorList from '~/components/ContributorList.astro'

**Contributors** <ContributorList>Contributor</ContributorList>