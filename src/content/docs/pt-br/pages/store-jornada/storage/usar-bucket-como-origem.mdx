---
title: Como usar um bucket do Edge Storage como a origem de uma edge application estática
description: >-
  Aprenda a usar um bucket como a origem de uma edge application estática usando
  Edge Storage e a tornar o conteúdo do bucket público.
meta_tags: >-
  edge storage, storage, cloud, s3, bucket, objects, files, storage, file
  storage, origin, object storage
namespace: documentation_products_sotre_storage_object_storage_origin
permalink: /documentacao/produtos/store/storage/usar-bucket-como-origin/
menu_namespace: storeMenu
---

import LinkButton from 'azion-webkit/linkbutton'
import Tabs from '~/components/tabs/Tabs'
import Code from '~/components/Code/Code.astro'

import originRollout from '~/includes/snippets/originRollout/pt/snippet.mdx'

</originRollout>

:::caution[Importante]
Você está visualizando a versão mais recente desta documentação. Se a sua conta ainda não foi migrada, consulte o [Guia legado de como utilizar o Edge Storage como origem](/pt-br/documentacao/produtos/build/edge-application/origins/v3/).
:::

Este guia mostra como configurar um bucket como origem de uma edge application usando a [API da Azion](https://api.azion.com/), [Azion CLI](/pt-br/documentacao/produtos/azion-cli/visao-geral/), e [Azion Runtime](/pt-br/documentacao/runtime/api-reference/storage/).

<LinkButton link="/pt-br/documentacao/produtos/store/edge-storage/" label="Consulte a referência do Edge Storage" severity="secondary" target="_blank" />

---

## Criar um bucket e fazer upload de arquivos

Esta seção descreve como você pode fazer upload de objetos para um bucket e manter a estrutura do projeto usando a [API da Azion](https://api.azion.com). Neste cenário, você criará uma aplicação estática usando dois arquivos, distribuídos em pastas da seguinte forma:

<Code lang="txt" code={`src/index.html
src/styles/style.css
`} />

1. Crie o seguinte arquivo `index.html` em um diretório local `src`:

<Code lang="html" code={`<!-- src/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <h1>Hello world!</h1>
    <p>I am an object from a bucket.</p>
</body>
</html>
`} />

2. Agora crie o arquivo `style.css`, que é referenciado no HTML, dentro de uma pasta `styles` no mesmo diretório:

<Code lang="css" code={`/* src/styles/style.css */
body {
background-color: black;
}

h1, p {
    color: #F3652B;
}
`} />

3. Execute a seguinte requisição `POST` no seu terminal, substituindo `[TOKEN VALUE]` pelo seu [personal token](/pt-br/documentacao/produtos/guias/personal-tokens/) e escrevendo o nome desejado do bucket em `name` para criar um bucket de leitura apenas:

<Code lang="bash" code={`curl --location 'https://api.azion.com/v4/storage/buckets' \
--header 'Accept: application/json;' \
--header 'Content-Type: application/json' \
--header 'Authorization: Token [TOKEN VALUE]' \
--data '{
    "name": "app-origin",
    "edge_access": "read_only"
}'
`} />

4. Você deve receber a seguinte resposta:

<Code lang="json" code={`{
  "state": "executed",
  "data": {
    "name": "app-origin",
    "edge_access": "read_only"
  }
}
`} />

5. Execute as seguintes requisições `POST` no seu terminal para cada arquivo, substituindo `<bucket_name>` pelo nome do bucket que você acabou de criar:

   - Para o arquivo `index.html`, execute o seguinte comando usando `src/index.html` como a chave do objeto, e adicionando o caminho do objeto como dados:

<Code lang="bash" code={`curl --location 'https://api.azion.com/v4/storage/buckets/<bucket_name>/objects/src/index.html' \
--header 'Accept: application/json;' \
--header 'Content-Type: text/html' \
--header 'Authorization: Token [TOKEN VALUE]' \
--data '@./src/index.html'
`} />

   - Para o arquivo `styles.css`, execute o seguinte comando usando `src/styles/style.css` como a chave do objeto, e adicionando o caminho do objeto como dados:

<Code lang="bash" code={`curl --location 'https://api.azion.com/v4/storage/buckets/<bucket_name>/objects/src/styles/style.css' \
--header 'Accept: application/json;' \
--header 'Content-Type: text/css' \
--header 'Authorization: Token [TOKEN VALUE]' \
--data '@./src/styles/style.css'
`} />

6. Você deve receber as seguintes respostas para os arquivos:

<Code lang="json" code={`{
    "state": "executed",
    "data": {
        "object_key": "src/index.html"
    }
}
`} />

<Code lang="json" code={`{
    "state": "executed",
    "data": {
        "object_key": "src/styles/style.css"
    }
}
`} />

:::caution[Atenção]
Quando um bucket é configurado com **permissões de read-write**, qualquer usuário pode acessar e modificar seu conteúdo (por exemplo, enviando uma requisição PUT para sobrescrever arquivos). Se o bucket for usado como origem para uma edge application, essa configuração pode expor o conteúdo a modificações não autorizadas. No entanto, se o bucket for acessado através de uma edge function, o risco é gerenciado pela lógica implementada no código da função, permitindo que os desenvolvedores imponham controles mais rigorosos sobre quem pode acessar ou modificar os dados. Para mitigar riscos, sempre verifique as permissões necessárias para cada caso de uso e implemente controles de acesso adequados. Leia mais em [Autenticação e permissões](/pt-br/documentacao/produtos/store/edge-storage/#autenticacao-e-permissoes).
:::

---

## Crie uma edge application e defina o tipo de origem como Edge Storage

Agora que seu bucket está populado com arquivos, você pode criar uma nova edge application e um domínio para definir o bucket como a origem do conteúdo e servir esses objetos.

<Tabs client:visible>
    <Fragment slot="tab.console">Console </Fragment>
    <Fragment slot="tab.api">API </Fragment>
    <Fragment slot="tab.cli">CLI </Fragment>

<Fragment slot="panel.console">
Para facilitar esse processo, use o template [Edge Application Proxy](/pt-br/documentacao/produtos/guias/edge-application-proxy-template/):

1. Acesse [Azion Console](https://console.azion.com).
    - Se você ainda não tem uma conta, crie uma nova [visitando a página de inscrição](https://console.azion.com/signup).
2. Na página inicial, selecione a opção **+ Create**.
3. Encontre o cartão **Edge Application Proxy** na seção de templates e selecione-o.
4. Dê um nome fácil de lembrar para a sua aplicação.
5. Em **Route to bypass**, digite `/` para especificar o caminho raiz da aplicação.
6. Aguarde o término do processo de implantação.
7. Copie o domínio da aplicação, no formato `http://xxxxxxxxxx.map.azionedge.net/`.

:::note
O link para a edge application permite que você a veja no navegador. No entanto, leva um certo tempo para propagar e configurar a aplicação nas edge locations da Azion. Pode ser necessário aguardar alguns minutos para que a URL seja ativada e para que a página da aplicação seja efetivamente exibida no navegador.
:::

Agora você precisa configurar um novo **Edge Connector** para vincular sua aplicação ao seu bucket do Edge Storage. Para isso:

1. [Acesse o Azion Console](/pt-br/documentacao/produtos/guias/como-acessar-o-azion-console/) > **Edge Connector**.
2. Clique no botão **+ Edge Connector**.
3. Na seção **Geral**, dê um nome único e descritivo para seu conector (por exemplo, `Meu Edge Storage Connector`).
4. Na seção **Connector Type**, selecione **Edge Storage**.
5. Na seção **Opções de Conexão**:
    - Para **Bucket**, selecione o nome do bucket que você criou nos passos anteriores.
    - Para **Prefixo**, insira `/src` (ou o prefixo que você usou ao fazer upload dos objetos).
6. Defina o **Status** como **Ativo**.
7. Clique no botão **Salvar**.

Para ativar o Edge Connector na sua edge application:

1. Acesse a aba **Rules Engine**.
2. Edite a regra padrão ou adicione uma nova regra na **Request Phase**.
3. Na seção **Criteria**, para aplicar a origem para toda a aplicação, defina os critérios como 1If ${uri} starts with /`.
4. Na seção Behavior, selecione o comportamento **Set Edge Connector**.
5. Selecione o **Edge Connector** que deseja aplicar.
6. Clique no botão **Save**.
7. Aguarde algum tempo para que as alterações se propaguem para o edge.

Uma vez que as alterações tenham sido feitas, acesse `http://xxxxxxxxxx.map.azionedge.net/index.html` para ver o arquivo HTML que você carregou com o estilo CSS aplicado.
</Fragment>

<Fragment slot="panel.api">
1. Execute a seguinte requisição `POST` no seu terminal, substituindo `[TOKEN VALUE]` pelo seu [personal token](/pt-br/documentacao/produtos/guias/personal-tokens/):

<Code lang="bash" code={`
curl --request POST \
  --url https://api.azion.com/v4/edge_application/applications \
  --header 'Accept: application/json' \
  --header 'Authorization: Token [TOKEN VALUE]' \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "edge storage app",
  "modules": {
    "edge_cache": {
      "enabled": true
    },
    "edge_functions": {
      "enabled": true
    },
    "application_accelerator": {
      "enabled": false
    },
    "image_processor": {
      "enabled": false
    },
    "tiered_cache": {
      "enabled": false
    }
  },
  "active": true,
  "debug": false
}'
`} />

2. Você deve receber uma resposta semelhante a:

<Code lang="json" code={`{
  "state": "pending",
  "data": {
    "id": <edge_application_id>,
    "name": "edge storage app",
    "last_editor": "education@azion.com",
    "last_modified": "2025-07-25T19:06:13.854005Z",
    "modules": {
      "edge_cache": {
        "enabled": true
      },
      "edge_functions": {
        "enabled": true
      },
      "application_accelerator": {
        "enabled": false
      },
      "image_processor": {
        "enabled": false
      },
      "tiered_cache": {
        "enabled": false
      }
    },
    "active": true,
    "debug": false,
    "product_version": "3.0"
  }
}
`} />

3. Copie o valor do campo `<edge_application_id>` e salve para requisições posteriores.

4. Execute a seguinte requisição `POST` no seu terminal para criar um Edge Connector, substituindo `[TOKEN VALUE]` pelo seu [personal token](/pt-br/documentacao/produtos/guias/personal-tokens/):

<Code lang="bash" code={`curl --request POST \
  --url https://api.azion.com/v4/edge_connector/connectors \
  --header 'Accept: application/json' \
  --header 'Authorization: Token [TOKEN VALUE]' \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "edge storage connector",
  "active": true,
  "type": "edge_storage",
  "attributes": {
    "bucket": "app-origin",
    "prefix": "/"
  }
}'
`} />

5. Copie o valor do campo `<edge_connector_id>` e salve para requisições posteriores.

6. Você deve receber uma resposta semelhante a:

<Code lang="json" code={`{
    "id": <edge_connector_id>,
    "name": "edge storage connector",
    "last_editor": "education@azion.com",
    "last_modified": "2025-07-22T14:34:31.009649Z",
    "active": true,
    "product_version": "1.0",
    "type": "edge_storage",
    "attributes": {
      "bucket": "app-origin",
      "prefix": "/"
    }
}
`} />

7. Execute a seguinte requisição `POST` no seu terminal, substituindo `[TOKEN VALUE]` pelo seu [personal token](/pt-br/documentacao/produtos/guias/personal-tokens/):

<Code lang="bash" code={`curl --request POST \
  --url https://api.azion.com/v4/workspace/workloads \
  --header 'Accept: application/json' \
  --header 'Authorization: Token [TOKEN VALUE]' \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "edge storage domain",
  "active": true,
  "infrastructure": 1,
  "protocols": {
    "http": {
      "versions": [
        "http1",
        "http2"
      ]
    }
  },
  "workload_domain_allow_access": true
}'
`} />

8. Você deve receber uma resposta semelhante a:

<Code lang="json" code={`{
  "state": "pending",
  "data": {
    "id": workload_id,
    "name": "edge storage domain",
    "active": true,
    "last_editor": "education@azion.com",
    "last_modified": "2025-07-25T18:58:25.817955Z",
    "infrastructure": 1,
    "tls": {
      "certificate": null,
      "ciphers": 7,
      "minimum_version": "tls_1_3"
    },
    "protocols": {
      "http": {
        "versions": [
          "http1",
          "http2"
        ],
        "http_ports": [
          80
        ],
        "https_ports": [
          443
        ],
        "quic_ports": null
      }
    },
    "mtls": {
      "verification": null,
      "certificate": null,
      "crl": null
    },
    "domains": [],
    "workload_domain_allow_access": true,
    "workload_domain": "xxxxxxxxxxx.azionedge.net",
    "product_version": "1.0"
  }
}
`} />

9. Copie a URL no valor `workload_domain` e salve para acessar depois.

10. Execute a seguinte requisição `POST` para associar o Workload à sua Edge Application, substituindo `[TOKEN VALUE]` pelo seu [personal token](/pt-br/documentacao/produtos/guias/personal-tokens/), `<edge_application_id>` pelo ID da edge application e `<workload_id>` pelo id do Workload:

<Code lang="bash" code={`curl --request POST \
  --url https://api.azion.com/v4/workspace/workloads/<workload_id>/deployments \
  --header 'Accept: application/json' \
  --header 'Authorization: Token [TOKEN VALUE]' \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "Edge Storage App",
  "current": true,
  "active": true,
  "strategy": {
    "type": "default",
    "attributes": {
      "edge_application": <edge_application_id>
    }
  }
}'
`} />

11. Execute a seguinte requisição `POST` para criar uma regra no **Rules Engine**, substituindo `<edge_application_id>` pelo ID da Edge Application e `<edge_connector_id>` pelo ID do Edge Connector:

<Code lang="bash" code={`curl --request POST \
  --url https://api.azion.com/v4/edge_application/applications/<edge_application_id>/request_rules \
  --header 'Accept: application/json' \
  --header 'Authorization: Token [TOKEN VALUE]' \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "string",
  "active": true,
  "criteria": [
    [
      {
        "conditional": "if",
        "variable": "${uri}",
        "operator": "starts_with",
        "argument": "/"
      }
    ]
  ],
  "behaviors": [
    {
      "type": "set_edge_connector",
      "attributes": {
        "value": <edge_connector_id>
      }
    }
  ]
}'
`} />

12. Você deve receber uma resposta semelhante a:

<Code lang="json" code={`{
    "state": "pending",
    "data": {
      "id": <rule_id>,
      "name": "string",
      "active": true,
      "criteria": [
        [
          {
            "conditional": "if",
            "variable": "${uri}",
            "operator": "starts_with",
            "argument": "/"
          }
        ]
      ],
      "behaviors": [
        {
          "type": "set_edge_connector",
          "attributes": {
            "value": <edge_connector_id>
          }
        }
      ],
      "description": "",
      "order": 1,
      "last_editor": "education@azion.com",
      "last_modified": "2025-07-25T19:29:30.684210Z"
    }
}
`} />

13. Aguarde algum tempo para a propagação das alterações.

Uma vez que as alterações tenham sido feitas, acesse o domínio que você criou, no formato `http://xxxxxxxxxx.map.azionedge.net/index.html`, para ver o arquivo HTML que você carregou com o estilo CSS aplicado.

</Fragment>

<Fragment slot="panel.cli">
## Requisitos 

- [Azion CLI instalada](/pt-br/documentacao/produtos/azion-cli/visao-geral/#instalar-a-azion-cli). 
- [Um personal token configurado](/pt-br/documentacao/devtools/cli/globals/#token).

Para criar uma edge application com as configurações necessárias para usar um bucket como origem: 

<Code lang="bash" code={`azion create edge-application --name "edge storage app" --delivery-protocol "http" --http3 false --origin-type "single_origin" --address "httpbin.org" --origin-protocol-policy "preserve" --host-header "${host}" --browser-cache-settings "honor" --browser-cache-settings-maximum-ttl 0 --cdn-cache-settings "override" --cdn-cache-settings-maximum-ttl 0
`} />

</Fragment>

</Tabs>

:::tip
Após criar sua aplicação com um bucket do Edge Storage como origem, você pode gerenciar e configurar ajustes, como [configurações de cache](/pt-br/documentacao/produtos/guias/cache-settings/).
:::

Aprenda como usar um bucket do Edge Storage como a origem de uma edge application estática. Assista ao vídeo abaixo:
<div class="cms-embed">
  <iframe width="600" height="400" src="https://www.youtube.com/embed/jMuwaqTEolg?si=_7sgVIi7MeNH8Yf4" loading="lazy" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
</div>
