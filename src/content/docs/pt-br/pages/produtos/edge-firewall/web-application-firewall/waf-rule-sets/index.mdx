---
title: WAF Rule Sets
description: WAF Rule Sets
meta_tags: WAF Rule Sets, Edge Computing, Security
namespace: documentation_products_web_application_firewall_waf_rule_sets
permalink: /documentacao/produtos/edge-firewall/waf-rule-sets/
---

O **WAF Rule Set** protege as suas aplicações contra ameaças como SQL Injections, Remote File Inclusion (RFI), Cross-Site Scripting (XSS) e muito mais. O WAF analisa as requisições HTTP e HTTPS, detecta e bloqueia atividades maliciosas antes que elas alcancem a sua infraestrutura, sem impactar na performance de suas aplicações.

---

## Monitorar a detecção de ameaças

Deixe a **WAF Rule Set** em  **Counting Mode ** pelo tempo que julgar necessário para que a maior parte das funcionalidades de sua aplicação sejam cobertas. 

> Você deve acompanhar os gráficos da aba **WAF** pelo **Real-Time Metrics** > **Edge Applications** ou os **logs do WAF** por meio dos produtos **Real-Time Events** e **Data Streaming**.

No **Real-Time Metrics**, o primeiro gráfico da aba *WAF (Threats vs Requests)* apresenta três séries temporais:

*   **Regular Requests:** todas as requisições HTTP e HTTPS analisadas pelo WAF e consideradas seguras.
*   **Threats:** o volume de ameaças detectadas pelo WAF e contabilizadas, quando em  **Counting Mode**. Essas ameaças não estão sendo bloqueadas nesse momento.
*   **Threats Blocked:** ameaças efetivamente bloqueadas pelo WAF. Para começar a bloquear as ameaças encontradas, a rule set tem que estar em **Blocking Mode**.

Se você possuir também o serviço **Data Streaming**, é possível acompanhar informações mais detalhadas sobre IP, data e horário de acesso, status code, família de ataque detectada e modo de atuação configurado.


~~~
$time-iso8601 $azion-client-id $azion-virtualhost-id $azion-configuration-id $azion-solution $azion-solution-id $host $conn-request-time $req-method $resp-status $req-uri $waf-threat-family $waf-threat-action $client-geoip-country-name $client-geoip-region-name $client-addr $client-port $req-header(User-Agent) $req-header(Referer) 2017-01-04T17:00:19+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.129 GET 200 /request-uri?key=value $XSS $LEARNING-BLOCK Brazil Sao Paulo 1.2.3.4 61511 Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:19+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.025 POST 200 /request-uri $SQL $LEARNING-BLOCK Brazil Santa Catarina 2.3.4.5 61513 Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:40+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.026 GET 301 /request-uri?key=value $RFI $LEARNING-BLOCK Brazil Rio de Janeiro 5.6.7.8 26102 Mozilla/5.0 (Linux; Android 5.1.1; SM-G800H Build/LMY47X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.91 Mobile Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:41+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.391 POST 200 /request-uri $UWA $LEARNING-BLOCK Brazil Rio Grande do Sul 9.10.11.12 26102 Mozilla/5.0 (Linux; Android 5.1.1; SM-G800H Build/LMY47X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.91 Mobile Safari/537.36 https://www.yoursite.com/referrer
~~~

Com base nessas informações, você pode ajustar a sensibilidade da *WAF Rule Set*, até que não ocorram mais falsos positivos. Ou mesmo solicitar para Azion a geração de _whitelist_ para sua aplicação.

