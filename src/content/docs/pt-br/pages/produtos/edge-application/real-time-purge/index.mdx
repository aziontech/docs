---
title: Real-Time Purge
description: Por meio do Real-Time Purge você pode deletar instantaneamente o cache de seu conteúdo na Azion.
meta_tags: Real-Time Purge, Edge Computing
namespace: documentation_products_edge_applications_real_time_purge
permalink: /documentacao/produtos/edge-application/real-time-purge/
---

O **Real-Time Purge** permite que você exclua instantaneamente o cache de seu conteúdo na Azion. Ao atualizar o conteúdo em sua origem, você deve escolher a melhor estratégia para atualizá-lo no cache da Azion.

Ao configurar suas políticas de cache, você determina o tempo que deseja que seus objetos fiquem em cache na Azion. Quando você atualiza seu conteúdo na origem, a Azion pode continuar fornecendo uma cópia em cache pelo tempo que você definiu para ser armazenado em cache. Com o Real-Time Purge, você pode excluir instantaneamente o cache de seu conteúdo na Azion, tanto do **Edge Caching** quanto do **L2 Caching**. Dessa forma, a Azion buscará a última versão de seu conteúdo direto na origem.

Porém, se objetos específicos armazenados em cache precisarem ser removidos do edge antes de expirarem, você tem a opção de limpar o cache com o Real-Time Purge. A limpeza regular do cache ajuda você a:

- Garantir que os usuários recebam o conteúdo mais atualizado e experimentem as alterações mais recentes na sua aplicação.
- Evitar que os usuários visualizem conteúdo obsoleto.
- Fornecer conteúdo compatível com navegadores e dispositivos modernos.
- Fornecer respostas de API e cache de conteúdo dinâmico sem sacrificar a experiência do usuário.
- Controlar como seus objetos são servidos pela Azion.
- Gerenciar objetos obsoletos ou desatualizados, ajudando seus desenvolvedores a criar soluções confiáveis, resilientes e de melhor desempenho.

### Boas práticas

Para garantir que os *purges* de cache sejam seguros e controlados, você deve manter o versionamento nos nomes de objetos. Ao atualizar o objeto em sua origem, você pode adicionar a versão no nome do objeto, forçando cada modificação de seu conteúdo a ser tratada como um novo objeto pela Azion.

Para versionar seus objetos, você pode usar um número sequencial, um *timestamp*, ou qualquer mecanismo que considere apropriado como marcação de versionamento. Por exemplo, em vez de nomear uma imagem como `image.jpg`, você pode nomeá-la `image_1.jpg` e, quando precisar atualizá-la, alterar a versão para `image_2.jpg`.

Dessa forma, cada atualização de conteúdo será tratada como um novo objeto pela Azion, o que lhe permite controlar qual objeto uma solicitação deve retornar, mesmo que o usuário tenha a versão anterior salva localmente no cache do navegador ou em algum cache intermediário.
Você também poderá fornecer diferentes versões de seus objetos para diferentes usuários e simplificar o processo de rollback em caso de problemas com sua atualização.

### Método `DEL`

Se você utilizar o método `DEL` para remover o objeto do cache em vez de **Real-Time Purge**, na próxima requisição de conteúdo do usuário, será feita uma requisição incondicional `GET` para a origem. No entanto, esse método impede que a Azion entregue [objetos stale](/en/documentation/products/edge-application/edge-caching/#stale-cache) se a origem estiver inacessível, entregando uma página de erro em seu lugar.

Você pode usar o `DEL` se seu objetivo for:

- Remover o conteúdo do cache da Azion após ele ter sido removido da origem.
- Forçar a remoção e atualização de conteúdos para os quais o *timestamp* não seja confiável.
- Forçar a entrega de uma página de erro em vez de um objeto obsoleto se sua origem estiver inacessível e a Azion não puder obter a versão mais recente de seu conteúdo.

---

## Layer

O **Real-Time Purge** oferece duas opções para limpar seu cache:

- **Edge Caching**: limpa o cache que é mantido no edge.
- **L2 Caching**: limpa o cache da *Layer 2* no edge. Requer que o módulo [L2 Caching](/pt/documentation/products/edge-application/l2-caching/) esteja ativo.

## Purge por URL

Limpa objetos em cache através de uma lista de URLs como argumento.

A *purge* da URL é não recursiva, ou seja, somente URLs inseridas serão removidas do cache. As URLs são convertidas automaticamente em suas respectivas *cache keys*, sem considerar qualquer variação de conteúdo na URL. 

:::note
As variações de conteúdo baseadas em cookies, grupos de dispositivos, imagens processadas, ou outros não expiram com essa operação. Considere o uso de **purge** por [cache key](#cache-key-purge) ou [wildcard](#wildcard-purge) para essas situações.
:::

A expiração das variações de conteúdo com base na string de consulta pode ser executada usando a **purge** de URL, já que uma string de consulta é um componente da URL, desde que os argumentos usados para a variação de conteúdo sejam enviados na ordem correta em que foram apresentados. Se você tiver ativado [Query String Sort](/en/documentation/products/edge-application/cache-settings/#cache-by-query-string), classifique os argumentos na solicitação ou considere o uso da *cache key purge* ou da *wildcard purge* como alternativa.

### Argumentos de purge por URL

O formato da URL deve respeitar o padrão: `scheme://host` ou apenas `host`, seguido ou não de um `/path` e da `?query-string`. Quando o `scheme` não for informado, o conteúdo será eliminado tanto de HTTP quanto de HTTPS.

:::caution
Se você usar o caractere asterisco (`*`) em uma **URL Purge**, ele será tratado como um caractere na URL e não como um *wildcard*.
:::

Por exemplo:

- `http://www.seudominio.com`
- `http://static.seudominio.com/include/site.css`
- `https://static.seudominio.com/include/site.js`
- `dynamic.seudominio.com/app.py?argumento`

---

## Purge por Cache Key

Limpa objetos em cache através de uma lista de *cache keys* como argumento. 

Uma *cache key* é uma entrada de índice para um objeto no cache da Azion. O formato padrão de *cache key* adotado pela Azion usa *URL host* e *path* para identificar objetos. Você pode especificar uma *cache key* para identificar diferentes variações de um objeto, com base em:

- string de consulta ou argumentos de classificação de string de consulta.
- cookies ao usar [Advanced Cache Key](/en/documentation/products/edge-application/cache-settings/#advanced-cache-key).
- formato de imagem de acordo com o suporte do navegador ao usar [Image Processor](/en/documentation/products/edge-application/image-processor/).

Para obter a *cache key*, você deve fazer uma solicitação `HEAD` para o conteúdo usando o cabeçalho de debug da Azion `Pragma: azion-debug-cache`, por exemplo:

```
HEAD /path HTTP/1.1
Host: seudominio.com
Pragma: azion-debug-cache
```

A resposta irá retornar um cabeçalho `X-Cache-Key` com a *cache key*, por exemplo:

```
X-Cache-Key: seudominio.com/path@@
```

Cada variação de objeto é representada por uma *cache key* diferente e é removida individualmente.

### Argumentos de purge por cache key

Se houver uma variação de objeto por [grupo de dispositivos](/en/documentation/products/edge-application/device-groups/), cada URL em cada grupo terá uma *cache key* diferente com o separador `@@` e o nome do grupo de dispositivos. Para limpar todas as variações, você deve procurar a *cache key* individualmente para cada grupo.

Por exemplo:

- `www.seudominio.com/@@`
- `www.seudominio.com/@@Mobile`
- `static.seudominio.com/include/site.css`
- `static.seudominio.com/include/site.js`
- `static.seudominio.com/static/images/image_1.jpg?ims=880x@@`
- `static.seudominio.com/static/images/image_1.jpg?ims=880x@@webp`

### Configurações de cache key personalizada

Se você tiver definido uma *cache key* personalizada sem usar **Advanced Cache Key**, deverá usar a purga da chave de cache para excluir o cache dos seus objetos. Além de `host` e `path`, a chave de cache pode incluir o separador `@@` seguido de argumentos personalizados. Por exemplo:

- `dynamic.yourdomain.com/path@@custom_arguments`

Você precisa fazer referência ao formato personalizado da sua *cache key* para executar a limpeza.

---

## Purge por Wildcard

Limpa o objeto em cache fornecendo uma expressão *wildcard* como argumento.

### Argumentos de purge por wildcard

O formato da expressão wildcard deve estar de acordo com o padrão: `scheme://host` ou apenas `host`, seguido ou não de `/path` e `?query-string`, com um caractere de asterisco (`*`) no path ou na query string. Você pode até usar vários *wildcards* para corresponder a um padrão complexo de um path.

A expressão *wildcard* é convertida automaticamente em vários objetos no mesmo domínio. Para remover as variações de conteúdo com base em cookies, grupos de dispositivos ou formato de imagem, para a mesma URL, use a URL com a expressão `@@*` no final.

Por exemplo:

- `www.yourdomain.com/*`
- `static.yourdomain.com/include/*.css`
- `static.yourdomain.com/*/site.js`
- `static.yourdomain.com/static/images/image_1.jpg?ims=*`
- `dynamic.yourdomain.com/app.py@@*`
- `www.yourdomain.com/alpha*`
- `www.yourdomain.com/*beta*`
- `www.yourdomain.com/*a*/charlie`
- `www.yourdomain.com/*a*/*a*`
- `www.yourdomain.com/*?b*`
- `www.yourdomain.com/*?*2*c=*`

:::note
Você não pode fazer a limpeza do **L2 Caching** usando uma expressão *wildcard*.
:::

---

## Application Acceleration purge

When using cookie-based content variation with [Application Acceleration](/en/documentation/products/edge-application/application-acceleration/), in addition to the *host* and *path*, the cache key must include the `@@` separator followed by the name of the cookies used and values.

For example, for the same URL `http://www.yourdomain.com/`, using content variation based on the `user` cookie, the cache keys could be:

- `www.yourdomain.com/@@`
- `www.yourdomain.com/@@user=user1`
- `www.yourdomain.com/@@user=user2`
