---
title: Como fazer o tuning do WAF
description: >-
  Filtre possíveis ataques no seu WAF e crie uma regra permitida a partir dos
  resultados que você recebe.
meta_tags: 'secure, waf, edge firewall, tune'
namespace: docs_guides_secure_tune_waf
permalink: /documentacao/produtos/guias/secure/tune-waf/
---

import Tag from 'primevue/tag'
import LinkButton from 'azion-webkit/linkbutton'
import Tabs from '~/components/tabs/Tabs'
import Apiv4Rollout from '~/includes/snippets/apiv4Rollout/pt/snippet.mdx'

<Apiv4Rollout />

Você pode usar o recurso [WAF Tuning](/pt-br/documentacao/produtos/secure/edge-firewall/web-application-firewall/#waf-tuning) para analisar listas de redes, IPs e países que correspondem aos conjuntos de regras do WAF configurados.

Neste guia, você filtrará possíveis ataques no seu WAF e criará uma regra permitida (*allowed rule*) a partir dos resultados que você recebe.

---

## Faça o tuning do WAF

Requer:

- <Tag severity="info" client:only="vue">[Um edge firewall configurado]()</Tag><br></br>

- <Tag severity="info" client:only="vue">[WAF ativado no edge firewall](/pt-br/documentacao/produtos/guias/secure/edge-firewall-definir-main-settings/)</Tag>

<Tabs client:visible>
    <Fragment slot="tab.consoleworkloads">Console - Workloads</Fragment>
    <Fragment slot="tab.consoledomains">Console - Domains</Fragment>

<Fragment slot="panel.consoleworkloads">

Após definir as configurações iniciais, proceda da seguinte maneira:

1. Acesse o [Azion Console](/pt-br/documentacao/produtos/guias/como-acessar-o-azion-console/) > **WAF Rules**.
2. Selecione o WAF Rule Set que deseja usar ou [crie um novo](/pt-br/documentacao/produtos/guias/secure/criar-waf-rule-set/).
3. Selecione a aba **Tuning**.
    - Você encontrará as variáveis disponíveis para filtrar.
4. Defina o **intervalo de tempo** que deseja analisar.
5. No menu suspenso **Workloads**, selecione os workloads que deseja analisar. Campo obrigatório.
6. Você também pode filtrar por **lista de redes**.
7. Opcionalmente, você pode clicar no botão **+ Filter** para filtrar por **Endereço IP** ou **País**
    - Nesse caso, clique no botão **Apply**.

Para exemplificar uma situação real, vamos supor a existência de algumas variáveis:

1. Em **Time Range**, selecione **Last 12 hours**.
2. Em **Workloads**, selecione `www.mydomain.com` e `www.anotherdomain.com`.
3. Em **Network List**, selecione **Blocklist IPs**.

Você receberá uma lista de registros referentes aos filtros que aplicou. Neste caso, registros que dão match com a network list `Blocklist IPs`.

Você pode fazer uma análise detalhada dos registros clicando em cada um deles com informações sobre **Rule IDs**, **Hits**, **Paths**, **IPs**, **Countries**, **Top 10 IPs Address** e **Top 10 Countries**.

</Fragment>

<Fragment slot="panel.consoledomains">

Após definir as configurações iniciais, proceda da seguinte maneira:

1. Acesse o [Azion Console](/pt-br/documentacao/produtos/guias/como-acessar-o-azion-console/) > selecione **WAF Rules**.
2. Selecione o WAF Rule Set que deseja usar ou [crie um novo](/pt-br/documentacao/produtos/guias/secure/criar-waf-rule-set/).
3. Selecione a aba **Tuning**.
    - Você encontrará as variáveis disponíveis para filtrar.
4. Defina o intervalo de tempo (Time range) que deseja analisar.
5. No menu suspenso **Domain(s)**, selecione os domínios que deseja analisar. Campo obrigatório.
6. Você também pode filtrar por Lista de redes (Network List)
7. Opcionalmente, você pode clicar no botão ** +Filter** para filtrar por Endereço IP (**IP Address**) ou País (**Country**).
    - Nesse caso, clique no botão **Apply**.

Para exemplificar uma situação real, vamos supor a existência de algumas variáveis:

1. Em **Time Range**, selecione **Last 12 hours**.
2. Em **Domain(s)**, selecione `www.mydomain.com` e `www.anotherdomain.com`.
3. Em **Network List**, selecione **Blocklist IPs**.

Você receberá uma lista de registros referentes aos filtros que aplicou. Neste caso, registros que dão match com a network list `Blocklist IPs`.

Você pode fazer uma análise detalhada dos registros clicando em cada um deles com informações sobre **Rule IDs**, **Hits**, **Paths**, **IPs**, **Countries**, **Top 10 IPs Address** e **Top 10 Countries**.
</Fragment>
</Tabs>

---

## Crie uma Allowed Rule

Ao filtrar uma consulta com o WAF Tuning, você pode criar uma [allowed rule](/pt-br/documentacao/produtos/secure/edge-firewall/web-application-firewall/custom-allowed-rules/) a partir dos resultados apresentados. Para fazer isso:

1. Use a caixa de seleção **Field** para selecionar os registros para os quais deseja criar uma regra permitida.
    - Você pode selecionar quantos registros quiser.
2. Clique no botão **Allow Rules**.

Você pode ir para a aba **Allowed Rules** na página **WAF Rules** para verificar se a regra permitida foi criada com sucesso. Todas as novas requisições para os domínios especificados no seu edge firewall configurado serão tratadas de acordo com as novas regras adicionadas.

---