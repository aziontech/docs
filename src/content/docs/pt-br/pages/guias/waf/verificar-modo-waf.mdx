---
title: Como verificar o modo do seu WAF
description: Aprenda a verificar e alterar o modo de operação das configurações do WAF.
meta_tags: 'edge firewall, web application firewall, learning, blocking, operation modes'
namespace: documentation_how_to_configurations_check_WAF_mode
menu_namespace: secureMenu
permalink: /documentacao/produtos/guias/como-verificar-modo-do-seu-waf/
---

import Tabs from '~/components/tabs/Tabs'
import Apiv4Rollout from '~/includes/snippets/apiv4Rollout/pt/snippet.mdx'

O **Web Application Firewall (WAF)** da Azion pode operar em dois modos diferentes, modo de aprendizagem (*learning*) e modo de bloqueio (*blocking*). No modo de aprendizagem, o WAF analisará as ameaças, sem bloqueá-las. No modo de bloqueio, todas as requisições consideradas ameaças são bloqueadas e nem chegam ao servidor (origem).

Rodar o WAF em modo de aprendizagem (ou *estágio de calibração*) ajuda a melhorar o seu funcionamento e reduz falsos positivos. O modo de bloqueio fornecerá proteção, em tempo real, contra todas as famílias de ameaças suportadas.

<Apiv4Rollout />

:::tip[Migração de API]
Se você está migrando da API v3 para a API v4, consulte o [guia de migração da API v3 para API v4](/pt-br/documentacao/devtools/api-v4/migrar/).
:::

:::tip
Veja a lista de todas [as famílias de ameaças](/pt-br/documentacao/produtos/secure/edge-firewall/web-application-firewall/) das quais o WAF protege.
:::

Este guia irá lhe orientar a criar, conferir e editar o modo de operação de um WAF Rule Set.

> WAF Rule Set é como é chamada uma configuração de WAF.

---

## Pré-requisitos

O modo de operação do WAF é definido na aba **Rules Engine** de um **Edge Firewall**. Por isso, lembre-se de ter:

- Um [edge firewall](/pt-br/documentacao/produtos/guias/secure/edge-firewall-definir-main-settings/), com os domínios de suas edge applications associados.
- Esse edge firewall deve ter pelo menos um [WAF Rule Set](/pt-br/documentacao/produtos/secure/edge-firewall/web-application-firewall/rule-sets/) configurado.

Se você não tiver um WAF Rule Set configurado, leia [este guia](/pt-br/documentacao/produtos/guias/secure/criar-waf-rule-set/) para mais detalhes.

---

<Tabs client:visible>
    <Fragment slot="tab.console-workloads">Console (Workloads)</Fragment>
    <Fragment slot="tab.console-domains">Console (Domains)</Fragment>
    <Fragment slot="tab.apiv4">API v4</Fragment>
    <Fragment slot="tab.apiv3">API v3</Fragment>

<Fragment slot="panel.console-workloads">

## Como verificar e editar o modo de operação do WAF via Console (Workloads)

Para conferir ou editar o modo de operação de um WAF, siga os passos:

1. Acesse o [Azion Console](/pt-br/documentacao/produtos/guias/como-acessar-o-azion-console/) > **Edge Firewall**, na seção **Secure**.
2. Na lista, localize e selecione o edge firewall que esteja rodando o WAF Rule Set que irá checar seu modo de operação.
3. Na aba **Main Settings**, certifique-se de:
   - Ter todos os domínios de suas edge applications selecionados na lista de domínios.
   - Ativar os switches dos módulos **Network Layer Protection** e **Web Application Firewall**.
   - Se fizer alguma alteração, clique no botão **Save**.
4. Clique na aba **Rules Engine**.
5. Selecione a regra associada ao WAF Rule Set que deseja conferir o modo de operação.

Esta regra deve ter uma lógica de Criteria/Behavior semelhante ao exemplo abaixo, e o modo de operação do WAF estará abaixo do nome da regra:

- Criteria: `If: [Request URI] [starts with] [/]`. <br />
- Behavior: `Then: [Set WAF Rule Set] [<name-of-waf-rule-set>] [Learning/Blocking]`.

6. Clique no botão **Save**.

</Fragment>

<Fragment slot="panel.console-domains">

## Como verificar e editar o modo de operação do WAF via Console (Domains)

Para conferir ou editar o modo de operação de um WAF, siga os passos:

1. Acesse o [Azion Console](/pt-br/documentacao/produtos/guias/como-acessar-o-azion-console/) > **Edge Firewall**, na seção **Secure**.
2. Na lista, localize e selecione o edge firewall que esteja rodando o WAF Rule Set que irá checar seu modo de operação.
3. Na aba **Main Settings**, certifique-se de:
   - Ter todos os domínios de suas edge applications selecionados na lista de domínios.
   - Ativar os switches dos módulos **Network Layer Protection** e **Web Application Firewall**.
   - Se fizer alguma alteração, clique no botão **Save**.
4. Clique na aba **Rules Engine**.
5. Selecione a regra associada ao WAF Rule Set que deseja conferir o modo de operação.

Esta regra deve ter uma lógica de Criteria/Behavior semelhante ao exemplo abaixo, e o modo de operação do WAF estará abaixo do nome da regra:

- Criteria: `If: [Request URI] [starts with] [/]`. <br />
- Behavior: `Then: [Set WAF Rule Set] [<name-of-waf-rule-set>] [Learning/Blocking]`.

6. Clique no botão **Save**.

</Fragment>

<Fragment slot="panel.apiv4">

## Como verificar e editar o modo de operação do WAF via API v4

Para verificar ou editar o modo de operação de um WAF usando a API v4, siga os passos:

1. Execute a seguinte requisição `GET` para recuperar seu edge firewall, substituindo `[TOKEN VALUE]` pelo seu [personal token](/pt-br/documentacao/produtos/guias/personal-tokens/):

```bash
curl --location 'https://api.azion.com/v4/edge_firewall/edge_firewalls' \
--header 'Accept: application/json; version=4' \
--header 'Authorization: Token [TOKEN VALUE]'
```

2. Você receberá uma resposta com todos os seus edge firewalls. Copie o `edge_firewall_id` que você deseja configurar.
3. Execute uma requisição `GET` para recuperar as regras do seu edge firewall:

```bash
curl --location 'https://api.azion.com/v4/edge_firewall/edge_firewalls/{edge_firewall_id}/rules_engine' \
--header 'Accept: application/json; version=4' \
--header 'Authorization: Token [TOKEN VALUE]'
```

4. Você receberá uma resposta com as regras. Encontre a regra com o WAF Rule Set que deseja configurar.
5. Execute uma requisição `PATCH` para atualizar a regra e alterar o modo WAF:

```bash
curl --location --request PATCH 'https://api.azion.com/v4/edge_firewall/edge_firewalls/{edge_firewall_id}/rules_engine/{rule_id}' \
--header 'Accept: application/json; version=4' \
--header 'Authorization: Token [TOKEN VALUE]' \
--header 'Content-Type: application/json' \
--data '{
  "behaviors": [
    {
      "name": "set_waf_ruleset",
      "argument": {
        "waf_mode": "learning" // ou "blocking"
      }
    }
  ]
}'
```

</Fragment>

<Fragment slot="panel.apiv3">

## Como verificar e editar o modo de operação do WAF via API v3

Para verificar ou editar o modo de operação de um WAF usando a API v3, siga os passos:

1. Execute a seguinte requisição `GET` para recuperar seu edge firewall, substituindo `[TOKEN VALUE]` pelo seu [personal token](/pt-br/documentacao/produtos/guias/personal-tokens/):

```bash
curl --location 'https://api.azionapi.net/v3/edge_firewall' \
--header 'Accept: application/json; version=3' \
--header 'Authorization: Token [TOKEN VALUE]'
```

2. Você receberá uma resposta com todos os seus edge firewalls. Copie o `id` que você deseja configurar.
3. Execute uma requisição `GET` para recuperar as regras do seu edge firewall:

```bash
curl --location 'https://api.azionapi.net/v3/edge_firewall/{id}/rules_engine' \
--header 'Accept: application/json; version=3' \
--header 'Authorization: Token [TOKEN VALUE]'
```

4. Você receberá uma resposta com as regras. Encontre a regra com o WAF Rule Set que deseja configurar.
5. Execute uma requisição `PUT` para atualizar a regra e alterar o modo WAF:

```bash
curl --location --request PUT 'https://api.azionapi.net/v3/edge_firewall/{id}/rules_engine/{rule_id}' \
--header 'Accept: application/json; version=3' \
--header 'Authorization: Token [TOKEN VALUE]' \
--header 'Content-Type: application/json' \
--data '{
  "behaviors": [
    {
      "name": "set_waf_ruleset",
      "argument": {
        "set_waf_ruleset_argument": "learning" // ou "blocking"
      }
    }
  ]
}'
```

</Fragment>

</Tabs>

---

