---
title: Como instalar a integração Fingerprint através do Marketplace da Azion
description: Use this integration to capture session data to better identify devices accessing your applications. 
meta_tags: proteção, cybersecurança, edge computing
namespace: docs_use_case_fingerprint
permalink: /documentacao/produtos/guias/fingerprint/
---

Azion **Fingerprint** permite que você capture dados de dispositivos e rede para melhor identificar os dispositivos que acessam suas aplicações. Ela pode ser classificada como uma integração de *Session Fingerprinting*, ou fingerprinting de sessão, e usa os dados coletados para gerar um identificador único e adicioná-lo como um cabeçalho de requisição.

Esta integração inclui duas funcionalidades:

- Um **script de nível de navegador** (opcional): um [código JavaScript](#embede-o-script) que pode ser adicionado à página web. Ele captura dados sobre o navegador e os define como um cookie de sessão (chamado `_azfp_sc`), então esses dados são sempre enviados pelo navegador. Mesmo quando o uso deste script é opcional, ele aumenta a precisão da integração.
- Uma **edge function** (obrigatória): uma função para capturar dados relacionados à conexão, bem como o "fingerprint do frontend" (criado pelo script do navegador), quando disponível, para criar o fingerprint da sessão. Em seguida, adicionará este fingerprint como um cabeçalho de requisição (chamado `X-AZFP`).

---

## Embede o script

O script do navegador é um código JavaScript que é executado na página da web que você deseja identificar, um processo também conhecido como injeção de JavaScript. Ele captura vários dados do navegador web:

- Suporte a áudio e vídeo
- Renderização de Canvas
- Se o navegador tem acesso à API de nível de dispositivo, como acelerômetro e giroscópio
- Dados do fabricante
- Fuso horário
- Renderização WebGL

Em seguida, ele cria um identificador único contendo todas essas informações e o define como um cookie de sessão chamado `_azfp_sc`, pois os cookies são sempre enviados nas requisições feitas pelo navegador. O script verifica se o cookie de sessão já existe. Se sim, ele não criará um novo.

Azion fornece um exemplo de código para fazer a injeção de JavaScript. 

1. Você pode encontrar o código [nesse arquivo](https://mal2u8n8zk.map.azionedge.net/274addd29ac1edb2b200a297b98581cd88465e2ee36f18cfdbdc063402063fe5.js)
2. Em seguida, adicioná-lo no seu HTML fonte. Exemplo:

```bash
<script src="anything.azion.xyz/arquivo.js"></script>
```

:::note
Esse passo é opcional, mas o uso deste script aumenta a precisão da integração **Fingerprint**. O código é um script modularizado, para evitar danos colaterais em quaisquer outros scripts que possam estar sendo executados na mesma página da web.
:::

---

## Obtenha a integração

Para instalar o **Fingerprint** da Azion:

1. Accesse o [Real-Time Manager (RTM)](/pt-br/documentacao/produtos/guias/como-acessar-o-rtm/) > **Marketplace**.
2. Na página inicial do Marketplace, selecione o card da integração.
3. Quando a página da integração abrir, clique no botão **Get It Now**, no canto inferior direito da página.

Uma mensagem de sucesso aparece para confirmar que sua integração está instalada.

:::tip
Você pode pesquisar qualquer integração navegando pelos cards ou digitando uma palavra-chave na barra de pesquisa.
:::

---

## Configure a integração

### Configure o Edge Firewall

Para fazer isso, siga os passos:

1. No canto superior esquerdo, selecione **Products menu** > **Edge Firewall** na seção **SECURE**.
2. Clique no botão **Add Rule Set**.
3. Dê um nome fácil de lembrar para sua nova regra.
4. Selecione os domínios que você deseja proteger com a função.
5. Ative o switch **Edge Functions** na seção **Edge Firewall Modules**.
6. Clique no botão **Save**.

Pronto. Agora você instanciou a regra para sua função e tem acesso a edge functions no seu edge firewall.

### Configure a função

Ainda na página **Edge Firewall**:

1. Selecione a aba **Functions**.
2. Clique no botão **Add Function**.
3. Dê um nome fácil de lembrar para sua instância.
4. No menu suspenso, selecione a função **Fingerprint**.

Esta ação carregará a função, mostrando um formulário com o código da função e, logo acima dele, duas abas: **Code** e **Args**.

Ao clicar na aba **Code**, você poderá navegar pelo código-fonte, mas não poderá alterá-lo.

Os seguintes dados são usados para criar o hash de identificação:

- Autonomous System Numbers (ASN)
- Cookie `_azfp_sc`
- Geoip City Code
- Geoip Country Code
- Geoip Region Code
- Header Accept
- Header Accept-CH
- Header Accept-Encoding
- Header Accept-Language
- Header User-Agent
- Header X-Forwarded-For
- Remote Address
- SSL Cipher
- SSL Version

Na aba **Args**, você passará suas variáveis. Neste caso, você deve declarar apenas as variáveis que deseja que a função **ignore**, como um **array de strings**. Não é uma ação obrigatória. Se deixado em branco, a função coletará todos os dados.

```json
{
  "fingerprint_ignore": []
}
```

Possíveis variáveis a serem ignoradas na criação do fingerprint:

- `cookie_fingerprint`: o cookie criado pelo [script do navegador](#embede-o-script), chamado `_azfp_sc`
- `header_accept`: os tipos de conteúdo que o cliente pode entender. Exemplo: `text/html`
- `header_accept_ch`: os cabeçalhos com hints do cliente que um cliente deve incluir em requisições subsequentes. Exemplo: `Viewport-Width, Width`
- `header_accept_encoding`: os algoritmos de codificação que um cliente suporta. Exemplo: `gzip`
- `header_accept_language`: o idioma preferido do cliente. Exemplo: `"en-US"`
- `header_user_agent`: o software e a versão usados pelo cliente. Exemplo: `Chrome/51.0.2704.106`
- `geoip_asn`: o ASN associado ao IP do dispositivo. Exemplo: `52580`
- `geoip_city`: a cidade associada ao IP do dispositivo. Exemplo: `"Brasilia"`
- `geoip_country_code`: o código do país associado ao IP do dispositivo. Exemplo: `"BR"`
- `geoip_region`: a região ou estado associado ao IP do dispositivo. Exemplo: `"DF"`
- `remote_addr`: o endereço IP remoto do dispositivo. Exemplo: `000.0.0.0`
- `ssl_cipher`: a cifra SSL usada na conexão do dispositivo. Exemplo: `"ECDHE-RSA-AES128-GCM-SHA256"`
- `ssl_protocol`: o protocolo SSL usado na conexão do dispositivo. Exemplo: `"TLSv1.2"`

:::note
Qualquer variável declarada como "null" ou em branco ainda será um valor válido.
:::

5. Quando terminar, clique no botão **Save**.

### Configure o Rules Engine

Para finalizar, você precisa configurar o **Rules Engine** para definir o *criteria* (critério) e o *behavior* (comportamento) para executar a função.

Ainda na página do **Edge Firewall**:

1. Selecione a aba **Rules Engine**.
2. Clique no botão **New Rule**.
3. Dê um nome fácil de lembrar para a regra.
   - Você pode adicionar uma descrição, mas é um passo opcional.
4. Selecione um  *criteria* para executar e capturar os domínios em que você deseja executar a integração.
5. Logo, selecione um *behavior* para o *criteria*. Neste caso, será **Run Function**.
6. Selecione a função adequada de acordo com o nome que você deu a ela na etapa de instanciação.
7. Clique no botão **Save**.

Pronto. Agora você pode coletar dados de sessão usando o **Fingerprint** da Azion.

---

import ContributorList from '~/components/ContributorList.astro'

**Contribuidores** <ContributorList>Contributor</ContributorList>