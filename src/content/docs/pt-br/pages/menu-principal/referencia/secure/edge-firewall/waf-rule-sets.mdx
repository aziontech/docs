---
title: WAF Rule Sets
description: WAF Rule Sets
meta_tags: WAF Rule Sets, Edge Computing, Security
namespace: documentation_products_web_application_firewall_waf_rule_sets
permalink: /documentacao/produtos/edge-firewall/waf-rule-sets/
---

import Button from '~/components/Button.astro'

O **Rules Engine para Web Application Firewall (WAF)** é um recurso desenvolvido para ajudá-lo a proteger suas aplicações no contexto das suas próprias aplicações. Com o Rules Engine para WAF, você pode definir seu próprio conjunto de regras de segurança (**Rule Sets**), desenvolvido especificamente para suas necessidades.

Essas regras são compostas de *criteria* e *behaviors*. As criteria representam as condições de execução das regras e os behaviors representam os comandos e as ações a serem executadas. Cada regra é processadas sequencialmente e, se as criteria forem atendidas, os behaviors de cada regra serão executados. **WAF Rule Set** é como é chamado um conjunto de regras personalizadas para Web Application Firewall.

## Pré-requisitos

Para configurar um **WAF Rule Set**, que é como uma configuração de WAF é chamada, você precisa ter uma configuração de Edge Firewall com o módulo **Web Application Firewall** ativado.

:::tip[dica]
Saiba mais sobre os [módulos do Edge Firewall](/pt-br/documentacao/produtos/edge-firewall/) e o [Rules Engine para o Edge Firewall](/pt-br/documentacao/produtos/edge-firewall/rules-engine/).
:::

## Monitorando detecção de ameaças com Real-Time Metrics

Deixe a **WAF Rule Set** em **Counting Mode** pelo tempo que julgar necessário para que a maior parte das funcionalidades de sua aplicação sejam cobertas. 

No **Real-Time Metrics**, o primeiro gráfico da aba (threats vs requests) apresenta três séries temporais:

- Regular Requests: todas as requisições HTTP e HTTPS analisadas pelo WAF e consideradas seguras.
- Threats: o volume de ameaças detectadas pelo WAF e contabilizadas, quando em modo *counting*. Essas ameaças não estão sendo bloqueadas nesse momento.
- Threats Blocked: ameaças efetivamente bloqueadas pelo WAF. Para começar a bloquear as ameaças encontradas, a rule set tem que estar em modo *blocking*.

<Button href="/pt-br/documentacao/produtos/real-time-metrics/" text="saiba mais sobre Real-Time Metrics" variant="secondary"></Button>

Se você possuir também o serviço **Data Streaming**, é possível acompanhar informações mais detalhadas sobre IP, data e horário de acesso, status code, família de ataque detectada e modo de atuação configurado.

```
$time-iso8601 $azion-client-id $azion-virtualhost-id $azion-configuration-id $azion-solution $azion-solution-id $host $conn-request-time $req-method $resp-status $req-uri $waf-threat-family $waf-threat-action $client-geoip-country-name $client-geoip-region-name $client-addr $client-port $req-header(User-Agent) $req-header(Referer) 2017-01-04T17:00:19+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.129 GET 200 /request-uri?key=value $XSS $LEARNING-BLOCK Brazil Sao Paulo 1.2.3.4 61511 Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:19+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.025 POST 200 /request-uri $SQL $LEARNING-BLOCK Brazil Santa Catarina 2.3.4.5 61513 Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:40+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.026 GET 301 /request-uri?key=value $RFI $LEARNING-BLOCK Brazil Rio de Janeiro 5.6.7.8 26102 Mozilla/5.0 (Linux; Android 5.1.1; SM-G800H Build/LMY47X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.91 Mobile Safari/537.36 https://www.yoursite.com/referrer 2017-01-04T17:00:41+00:00 1234a 10203b 1020304050 ha 1441740010 www.yoursite.com 0.391 POST 200 /request-uri $UWA $LEARNING-BLOCK Brazil Rio Grande do Sul 9.10.11.12 26102 Mozilla/5.0 (Linux; Android 5.1.1; SM-G800H Build/LMY47X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.91 Mobile Safari/537.36 https://www.yoursite.com/referrer
```

Com base nessas informações, você pode ajustar a sensibilidade da *WAF Rule Set*, até que não ocorram mais falsos positivos. Você também pode solicitar para a Azion a geração de uma *allowlist* para sua aplicação.




---

import ContributorList from '~/components/ContributorList.astro'

**Contribuidores** <ContributorList>Contributor</ContributorList>
